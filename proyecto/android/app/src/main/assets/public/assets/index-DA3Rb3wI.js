(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function i(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(o){if(o.ep)return;o.ep=!0;const a=i(o);fetch(o.href,a)}})();const P="https://www.stands4.com/services/v2/lyrics.php",D="13561",Q="fIBAnaMl96jrfCEI",R=[{title:"Bohemian Rhapsody",artist:"Queen"},{title:"Imagine",artist:"John Lennon"},{title:"Hotel California",artist:"Eagles"},{title:"Stairway to Heaven",artist:"Led Zeppelin"},{title:"Sweet Child O Mine",artist:"Guns N Roses"},{title:"Smells Like Teen Spirit",artist:"Nirvana"},{title:"Billie Jean",artist:"Michael Jackson"},{title:"Hey Jude",artist:"The Beatles"},{title:"Yesterday",artist:"The Beatles"},{title:"Every Breath You Take",artist:"The Police"},{title:"Shape of You",artist:"Ed Sheeran"},{title:"Someone Like You",artist:"Adele"},{title:"Rolling in the Deep",artist:"Adele"},{title:"Uptown Funk",artist:"Mark Ronson"},{title:"Thriller",artist:"Michael Jackson"},{title:"We Will Rock You",artist:"Queen"},{title:"Don't Stop Believin",artist:"Journey"},{title:"Sweet Dreams",artist:"Eurythmics"},{title:"Girls Just Want to Have Fun",artist:"Cyndi Lauper"},{title:"Take On Me",artist:"A-ha"},{title:"Livin' on a Prayer",artist:"Bon Jovi"},{title:"Like a Prayer",artist:"Madonna"},{title:"Purple Rain",artist:"Prince"},{title:"Beat It",artist:"Michael Jackson"},{title:"With or Without You",artist:"U2"}];async function O(t,n){try{if(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")){const c=new URLSearchParams;c.set("term",t||""),n&&c.set("artist",n);const f=`/api/lyrics?${c.toString()}`,p=await fetch(f,{method:"GET"});if(!p.ok)return console.warn("searchLyrics(proxy): respuesta no OK",p.status,p.statusText),null;const d=await p.text();let m=null;try{m=JSON.parse(d)}catch{m=null}if(m){const u=m.result||m,h=u.lyrics||u.lyric||u.text||u.lyrics_body||"",w=u.song||u.title||t,y=u.artist||n||"",x=u.album||u.release||"";return{title:w,artist:y,album:x,lyrics:h}}if(typeof DOMParser<"u"){const h=new DOMParser().parseFromString(d,"application/xml"),w=h.querySelector("result")||h.documentElement,y=v=>{for(const M of v){const A=w.querySelector(M);if(A&&A.textContent&&A.textContent.trim().length>0)return A.textContent.trim()}return""},x=y(["lyrics","lyric","text","lyrics_body","lyric_text"]),g=y(["song","title","track"]),q=y(["artist","singer"]),T=y(["album","release"]);return{title:g||t,artist:q||n||"",album:T||"",lyrics:x||""}}return{title:t,artist:n||"",album:"",lyrics:d||""}}const e=new URLSearchParams;e.set("uid",D),e.set("tokenid",Q),e.set("term",t||""),n&&e.set("artist",n),e.set("format","xml");const o=`${P}?${e.toString()}`,a=await fetch(o,{method:"GET"});if(!a.ok)return console.warn("searchLyrics: respuesta no OK",a.status,a.statusText),null;const l=await a.text();let L=null;try{L=JSON.parse(l)}catch{L=null}if(L){const c=L.result||L,f=c.lyrics||c.lyric||c.text||c.lyrics_body||"",p=c.song||c.title||t,d=c.artist||n||"",m=c.album||c.release||"";return{title:p,artist:d,album:m,lyrics:f}}if(typeof DOMParser<"u"){const f=new DOMParser().parseFromString(l,"application/xml"),p=f.querySelector("result")||f.documentElement,d=y=>{for(const x of y){const g=p.querySelector(x);if(g&&g.textContent&&g.textContent.trim().length>0)return g.textContent.trim()}return""},m=d(["lyrics","lyric","text","lyrics_body","lyric_text"]),u=d(["song","title","track"]),h=d(["artist","singer"]),w=d(["album","release"]);return{title:u||t,artist:h||n||"",album:w||"",lyrics:m||""}}return{title:t,artist:n||"",album:"",lyrics:l||""}}catch(i){return console.error("Error buscando letra:",i),null}}async function I(t){const n=R.find(e=>e.title.toLowerCase()===t.toLowerCase()),i=n?n.artist:"";try{const e=await O(t,i);return e?[{song:e.title||t,artist:e.artist||i||"",album:e.album||"",lyrics:e.lyrics||""}]:[]}catch(e){return console.warn("getLyricsData: error buscando",t,e),[]}}let s={currentScreen:"menu",questions:[],currentQuestion:0,score:0,selectedAnswer:null,showResult:!1,usedHint:!1};async function k(){const t=["Shape of You","Bohemian Rhapsody","Billie Jean","Perfect","Smells Like Teen Spirit"],n=[];for(const i of t)try{const e=await I(i);if(!e||e.length===0)continue;const o=e[0];if(Math.floor(Math.random()*2)===0&&o.artist){const l=S([o.artist,"Adele","Elton John","BeyoncÃ©"]);n.push({question:`Â¿QuiÃ©n interpreta la canciÃ³n "${o.song}"?`,correctAnswer:o.artist,options:l,hint:"",artist:o.artist,isLyric:!1,correct:l.indexOf(o.artist)})}else if(o.album){const l=S([o.album,"Greatest Hits","Unplugged","The Best Of 2020"]);n.push({question:`Â¿A quÃ© Ã¡lbum pertenece "${o.song}"?`,correctAnswer:o.album,options:l,hint:"",artist:o.artist||"",isLyric:!1,correct:l.indexOf(o.album)})}}catch(e){console.warn("Error al obtener datos para",i,e);continue}return n.length===0?S(E()):S(n)}function S(t){return t.sort(()=>Math.random()-.5)}function E(){return[{question:'Â¿QuÃ© compositor italiano escribiÃ³ la Ã³pera "La Traviata"?',correctAnswer:"Giuseppe Verdi",options:["Giuseppe Verdi","Giacomo Puccini","Gioachino Rossini","Richard Wagner"],hint:"",artist:"",isLyric:!1},{question:'Â¿En quÃ© aÃ±o se lanzÃ³ el Ã¡lbum "Kind of Blue" de Miles Davis?',correctAnswer:"1959",options:["1959","1956","1963","1960"],hint:"",artist:"",isLyric:!1},{question:"Â¿CuÃ¡l es la tonalidad principal de la SinfonÃ­a n.Âº5 de Beethoven?",correctAnswer:"Do menor",options:["Do menor","Re mayor","Mi bemol mayor","Sol menor"],hint:"",artist:"",isLyric:!1},{question:"Â¿QuÃ© tÃ©rmino describe la ornamentaciÃ³n vocal con mÃºltiples notas sobre una sola sÃ­laba (comÃºn en soul/gospel)?",correctAnswer:"Melisma",options:["Melisma","Glissando","Vibrato","Staccato"],hint:"",artist:"",isLyric:!1},{question:'Â¿QuÃ© banda lanzÃ³ el Ã¡lbum conceptual "The Dark Side of the Moon"?',correctAnswer:"Pink Floyd",options:["Pink Floyd","The Rolling Stones","Led Zeppelin","The Who"],hint:"",artist:"",isLyric:!1},{question:"Â¿QuÃ© instrumento tiene teclas y cuerdas que son golpeadas por martillos?",correctAnswer:"Piano",options:["Piano","Clave","Arpa","CÃ­tara"],hint:"",artist:"",isLyric:!1},{question:'Â¿QuiÃ©n compuso "La Primavera" dentro de "Las Cuatro Estaciones"?',correctAnswer:"Antonio Vivaldi",options:["Antonio Vivaldi","Johann Sebastian Bach","Wolfgang Amadeus Mozart","Ludwig van Beethoven"],hint:"",artist:"",isLyric:!1},{question:"Â¿CuÃ¡l es el nombre real del artista conocido como Sting (ex-The Police)?",correctAnswer:"Gordon Sumner",options:["Gordon Sumner","Paul Simon","David Byrne","Robert Plant"],hint:"",artist:"",isLyric:!1},{question:"Â¿QuÃ© ritmo latino fue popularizado por Tito Puente y Machito?",correctAnswer:"Mambo",options:["Mambo","Samba","Bachata","Bolero"],hint:"",artist:"",isLyric:!1},{question:"Â¿QuÃ© tÃ©rmino musical describe la repeticiÃ³n de una idea a diferentes alturas?",correctAnswer:"Secuencia",options:["Secuencia","Ostinato","Cadencia","ModulaciÃ³n"],hint:"",artist:"",isLyric:!1},{question:'Â¿QuÃ© productor britÃ¡nico es conocido por su trabajo con The Beatles (p. ej. "Sgt. Pepper")?',correctAnswer:"George Martin",options:["George Martin","Phil Spector","Brian Eno","Quincy Jones"],hint:"",artist:"",isLyric:!1},{question:"Â¿CuÃ¡ntos semitonos hay en una quinta justa?",correctAnswer:"7",options:["7","5","6","8"],hint:"",artist:"",isLyric:!1},{question:'Â¿QuiÃ©n compuso la canciÃ³n vallenata "La Casa en el Aire"?',correctAnswer:"Rafael Escalona",options:["Rafael Escalona","Diomedes DÃ­az","Carlos Vives","Leandro DÃ­az"],hint:"",artist:"",isLyric:!1},{question:'Â¿QuÃ© cantante vallenato es conocido como "El Cacique de La Junta"?',correctAnswer:"Diomedes DÃ­az",options:["Diomedes DÃ­az","Carlos Vives","Juancho Rois","Kaleth Morales"],hint:"",artist:"",isLyric:!1},{question:"Â¿QuÃ© acordeonero acompaÃ±Ã³ frecuentemente a Diomedes DÃ­az y es reconocido en el vallenato?",correctAnswer:"Juancho Rois",options:["Juancho Rois","Alejo DurÃ¡n","Emiliano Zuleta","Nicolas ElÃ­as"],hint:"",artist:"",isLyric:!1}].map(n=>{const i=S([...n.options]),e=i.indexOf(n.correctAnswer);return{question:n.question,correctAnswer:n.correctAnswer,options:i,hint:n.hint||"",artist:n.artist||"",isLyric:n.isLyric||!1,correct:e>=0?e:0}})}const B={menu:document.getElementById("menuScreen"),loading:document.getElementById("loadingScreen"),game:document.getElementById("gameScreen"),results:document.getElementById("resultsScreen")},r={playBtn:document.getElementById("playBtn"),playAgainBtn:document.getElementById("playAgainBtn"),questionCounter:document.getElementById("questionCounter"),scoreDisplay:document.getElementById("scoreDisplay"),hintLabel:document.getElementById("hintLabel"),hintText:document.getElementById("hintText"),artistText:document.getElementById("artistText"),optionsContainer:document.getElementById("optionsContainer"),nextBtn:document.getElementById("nextBtn"),finalScore:document.getElementById("finalScore"),resultMessage:document.getElementById("resultMessage")};r.hintHeader=document.querySelector(".hint-header");function J(t){return Number.isInteger(t)?String(t):t.toFixed(1)}r.hintHeader&&(r.hintHeader.style.cursor="pointer",r.hintHeader.addEventListener("click",()=>{const t=s.questions[s.currentQuestion];t&&(s.usedHint||t.artist&&(r.artistText.textContent=`Artista: ${t.artist}`,r.artistText.style.opacity="1",s.usedHint=!0))}));function b(t){Object.keys(B).forEach(n=>{B[n].classList.remove("active")}),setTimeout(()=>{B[t].classList.add("active")},50),s.currentScreen=t}async function G(){b("loading");try{s.questions=await k()}catch(t){console.error("Error generando preguntas:",t),s.questions=E()}s.currentQuestion=0,s.score=0,s.selectedAnswer=null,s.showResult=!1,s.usedHint=!1,setTimeout(()=>{b("game"),C()},1e3)}function C(){const t=s.questions[s.currentQuestion];r.questionCounter.textContent=`${s.currentQuestion+1}/${s.questions.length}`,r.scoreDisplay.textContent=s.score,r.hintLabel.textContent=t.isLyric?"LETRA":"PISTA",r.hintText.textContent=t.hint||t.question||"",r.artistText.textContent="",r.artistText.style.opacity="0.6",s.usedHint=!1,r.optionsContainer.innerHTML="",t.options.forEach((n,i)=>{const e=document.createElement("button");e.className="option-btn default",e.textContent=n,e.onclick=()=>H(i),r.optionsContainer.appendChild(e)}),r.nextBtn.classList.add("hidden"),s.showResult=!1,s.selectedAnswer=null}function H(t){if(s.showResult)return;const n=s.questions[s.currentQuestion];if(s.selectedAnswer=t,s.showResult=!0,t===n.correct){const e=s.usedHint?.5:1;s.score=Math.round((s.score+e)*100)/100,r.scoreDisplay.textContent=J(s.score)}r.optionsContainer.querySelectorAll(".option-btn").forEach((e,o)=>{e.disabled=!0,e.classList.remove("default"),o===n.correct?e.classList.add("correct"):o===t?e.classList.add("incorrect"):e.classList.add("disabled")}),r.nextBtn.classList.remove("hidden"),s.currentQuestion<s.questions.length-1?r.nextBtn.textContent="Siguiente Pregunta":r.nextBtn.textContent="Ver Resultados"}function N(){s.currentQuestion<s.questions.length-1?(s.currentQuestion++,C()):z()}function z(){const t=s.questions.length,n=s.score,i=n/t;r.finalScore.textContent=`${n}/${t}`,i===1?r.resultMessage.textContent="Â¡Perfecto! ðŸŽ‰":i>=.7?r.resultMessage.textContent="Â¡Excelente! ðŸŒŸ":i>=.5?r.resultMessage.textContent="Â¡Bien hecho! ðŸ‘":r.resultMessage.textContent="Â¡Sigue practicando! ðŸ’ª",b("results")}r.playBtn.addEventListener("click",G);r.playAgainBtn.addEventListener("click",()=>{b("menu")});r.nextBtn.addEventListener("click",N);document.addEventListener("DOMContentLoaded",()=>{b("menu")});
